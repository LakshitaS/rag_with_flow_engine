<!DOCTYPE html><html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta name="DC.Publisher" content="IBM Corporation">
  <meta name="DC.rights" content="© Copyright IBM Corporation {{ copyright.years }}">
  <meta name="IBM.Country" content="ZZ">
  <meta name="DC.Date" content="{{ lastupdated }}">
  <meta name="keywords" content="{{ keywords }}">
  <meta name="subcollection" content="{{ subcollection }}">
  <meta name="description" content="You can use Amazon SageMaker to log payload and feedback data, and to measure performance accuracy, bias detection, explainability, and auto-debias function in the IBM Watson OpenScale service.">
  <meta name="content.type" content="topic">
  <meta name="tags" content="{{ services }}">
  <meta name="account.plan" content="{{ account-plan }}">
  <meta name="completion.time" content="{{ completion-time }}">
  <meta name="version" content="{{ version }}">
  <meta name="deployment.url" content="{{ deployment-url }}">
  <meta name="industry" content="{{ industry }}">
  <meta name="compliance" content="{{ compliance }}">
  <meta name="use.case" content="{{ use-case }}">
  <meta name="source.format" content="markdown">




  <!-- Licensed Materials - Property of IBM -->
  <!-- US Government Users Restricted Rights -->
  <!-- Use, duplication or disclosure restricted by -->
  <!-- GSA ADP Schedule Contract with IBM Corp. -->

  <title>Amazon SageMaker frameworks</title>
<link rel="canonical" href="https://www.ibm.com/docs/en/watsonx-as-a-service?topic=models-amazon-sagemaker-frameworks"><meta name="viewport" content="width=device-width,initial-scale=1"></head>

<body>
  <main role="main">
    <article aria-labelledby="amazon-sagemaker-frameworks" role="article">
      <style>
        .midd::after {
          content: "\A\00A0\00A0";
          white-space: pre
        }
      </style>
      <section id="section-amazon-sagemaker-frameworks">
        <h1 id="amazon-sagemaker-frameworks">Amazon SageMaker frameworks</h1>
        <p>You can use Amazon SageMaker to log payload and feedback data, and to measure performance accuracy, bias detection, explainability, and auto-debias function in the IBM Watson OpenScale service.</p>
        <p>IBM Watson OpenScale fully supports the following Amazon SageMaker frameworks:</p>
        <p>Table 1. Framework support details</p>
        <table>
          <caption caption-side="top">Framework support details</caption>
          <thead>
            <tr>
              <th style="text-align:left">Framework</th>
              <th style="text-align:center">Problem type</th>
              <th style="text-align:center">Data type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align:left">Native</td>
              <td style="text-align:center">Classification</td>
              <td style="text-align:center">Structured</td>
            </tr>
            <tr>
              <td style="text-align:left">Native</td>
              <td style="text-align:center">Regression<sup>1</sup></td>
              <td style="text-align:center">Structured</td>
            </tr>
          </tbody>
        </table>
        <p><sup>1</sup>Support for regression models does not include drift magnitude.</p>
        <section id="section-frmwrks-aws-sage-add">
          <h2 id="frmwrks-aws-sage-add">Adding Amazon SageMaker to Watson OpenScale</h2>
          <p>You can configure Watson OpenScale to work with Amazon SageMaker by using one of the following methods:</p>
          <ul>
            <li>The first time that you add a machine learning provider to Watson OpenScale, you can use the configuration interface. For more information, see <a href="#csm-connect">Specifying an Amazon SageMaker instance</a>.</li>
            <li>You can also add your machine learning provider by using the Python SDK. You must use this method if you want to have more than one provider. For more information, see <a href="#cml-smbind">Add your Amazon SageMaker machine learning engine</a>.</li>
          </ul>
        </section>
        <section id="section-frmwrks-aws-sage-smpl-ntbks">
          <h2 id="frmwrks-aws-sage-smpl-ntbks">Sample Notebooks</h2>
          <p>The following Notebooks show how to work with Amazon SageMaker:</p>
          <ul>
            <li><a href="https://github.com/IBM/watson-openscale-samples/blob/main/IBM%20Cloud/AWS%20Sagemaker/notebooks/Credit%20%20model%20with%20SageMaker%20linear-learner%20.ipynb" target="_blank" class="external">Creation and deployment of credit risk prediction model</a></li>
            <li><a href="https://github.com/IBM/watson-openscale-samples/blob/main/IBM%20Cloud/AWS%20Sagemaker/notebooks/AI%20OpenScale%20and%20SageMaker%20ML%20Engine.ipynb" target="_blank" class="external">Data mart creation, model deployment monitoring and data analysis</a></li>
          </ul>
        </section>
        <section id="section-csm-connect">
          <h2 id="csm-connect">Specifying an Amazon SageMaker ML service instance</h2>
          <p>Your first step in the Watson OpenScale tool is to specify an Amazon SageMaker service instance. Your Amazon SageMaker service instance is where you store your AI models and deployments.</p>
        </section>
        <section id="section-csm-config">
          <h2 id="csm-config">Connect your Amazon SageMaker service instance</h2>
          <p>Watson OpenScale connects to AI models and deployments in an Amazon SageMaker service instance. To connect your service to Watson OpenScale, go to the <strong>Configure</strong> <img src="images/wos-config-tab.png" alt="The configuration tab icon">            tab, add a machine learning provider, and click the <strong>Edit</strong> <img src="images/wos-edit-icon.png" alt="The configuration tab icon displays."> icon. In addition to a name and description and whether the environment <strong>Pre-production</strong>            or <strong>Production</strong>, you must provide the following information that is specific to this type of service instance:</p>
          <ul>
            <li>Access Key ID: Your AWS access key ID, <code>aws_access_key_id</code>, which verifies who you are and authenticates and authorizes calls that you make to AWS.</li>
            <li>Secret Access Key: Your AWS secret access key, <code>aws_secret_access_key</code>, which is required to verify who you are and to authenticate and authorize calls that you make to AWS.</li>
            <li>Region: Enter the region where your Access Key ID was created. Keys are stored and used in the region in which they were created and cannot be transferred to another region.</li>
          </ul>
          <p>You are now ready to select deployed models and configure your monitors. Watson OpenScale lists your deployed models on the <strong>Insights</strong> dashboard where you can click <strong>Add to dashboard</strong>. Select the deployments that
            you want to monitor and click <strong>Configure</strong>.</p>
          <p>For more information, see <a href="wos-monitors-overview.html">Configure monitors</a>.</p>
        </section>
        <section id="section-cml-smconfig">
          <h2 id="cml-smconfig">Payload logging with the Amazon SageMaker machine learning engine</h2>
        </section>
        <section id="section-cml-smbind" help="" support="">
          <h2 id="cml-smbind">Add your Amazon SageMaker machine learning engine</h2>
          <p>A non-IBM Watson Machine Learning engine is bound as Custom by using metadata. No direct integration with the non-IBM Watson Machine Learning service is possible.</p>
          <pre class="codeblock"><code class="lang-python hljs">SAGEMAKER_ENGINE_CREDENTIALS = {
                   <span class="hljs-string">'access_key_id'</span>:””,
                   <span class="hljs-string">'secret_access_key'</span>:””,
                   <span class="hljs-string">'region'</span>: <span class="hljs-string">'}
 
wos_client.service_providers.add(
        name="AWS",
        description="AWS Service Provider",
        service_type=ServiceTypes.AMAZON_SAGEMAKER,
        credentials=SageMakerCredentials(
            access_key_id=SAGEMAKER_ENGINE_CREDENTIALS['</span>access_key_id<span class="hljs-string">'],
            secret_access_key=SAGEMAKER_ENGINE_CREDENTIALS['</span>secret_access_key<span class="hljs-string">'],
            region=SAGEMAKER_ENGINE_CREDENTIALS['</span>region<span class="hljs-string">']
        ),
        background_mode=False
    ).result
</span></code></pre>
          <p>To see your service subscription, run the following code:</p>
          <pre class="codeblock"><code class="lang-python hljs">client.service_providers.<span class="hljs-built_in">list</span>()
</code></pre>
          <p><img src="images/wos-ml-sagemaker-bind.png" alt="SageMaker ML binding"></p>
        </section>
        <section id="section-cml-smsub">
          <h2 id="cml-smsub">Add Amazon SageMaker ML subscription</h2>
          <p>To add the subscription, run the following code:</p>
          <pre class="codeblock"><code class="lang-python hljs">asset_deployment_details = wos_client.service_providers.list_assets(data_mart_id=data_mart_id, service_provider_id=service_provider_id).result
asset_deployment_details
&nbsp;
deployment_id=<span class="hljs-string">'684e35eee8a479470cee05983e1f9d64'</span>
<span class="hljs-keyword">for</span> model_asset_details <span class="hljs-keyword">in</span> asset_deployment_details[<span class="hljs-string">'resources'</span>]:
&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">if</span> model_asset_details[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'guid'</span>]==deployment_id:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">break</span>
&nbsp;
&nbsp;&nbsp;
aws_asset = Asset(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; asset_id=model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'asset'</span>][<span class="hljs-string">'asset_id'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name=model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'asset'</span>][<span class="hljs-string">'name'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; url=model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'asset'</span>][<span class="hljs-string">'url'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; asset_type=model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'asset'</span>][<span class="hljs-string">'asset_type'</span>] <span class="hljs-keyword">if</span> <span class="hljs-string">'asset_type'</span> <span class="hljs-keyword">in</span> model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'asset'</span>] <span class="hljs-keyword">else</span> <span class="hljs-string">'model'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; problem_type=ProblemType.BINARY_CLASSIFICATION,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; input_data_type=InputDataType.STRUCTURED,
&nbsp;&nbsp;&nbsp; )
&nbsp;
<span class="hljs-keyword">from</span> ibm_watson_openscale.base_classes.watson_open_scale_v2 <span class="hljs-keyword">import</span> ScoringEndpointRequest
deployment_scoring_endpoint = model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'scoring_endpoint'</span>]
scoring_endpoint = ScoringEndpointRequest(url = model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'scoring_endpoint'</span>][<span class="hljs-string">'url'</span>] )
&nbsp;
deployment = AssetDeploymentRequest(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deployment_id=model_asset_details[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'guid'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; url=model_asset_details[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'url'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name=model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'name'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-comment">#description="asset['entity']['description']",</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deployment_type=model_asset_details[<span class="hljs-string">'entity'</span>][<span class="hljs-string">'type'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scoring_endpoint =&nbsp; scoring_endpoint
&nbsp;&nbsp;&nbsp; )
&nbsp;
asset_properties = AssetPropertiesRequest(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label_column=<span class="hljs-string">"Risk"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prediction_field=<span class="hljs-string">'predicted_label'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; probability_fields=[<span class="hljs-string">'score'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; training_data_reference=training_data_reference,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; training_data_schema=<span class="hljs-literal">None</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; input_data_schema=<span class="hljs-literal">None</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output_data_schema=<span class="hljs-literal">None</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; feature_fields=feature_columns,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; categorical_fields=categorical_columns
&nbsp;&nbsp;&nbsp; )
&nbsp;
subscription_details = wos_client.subscriptions.add(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data_mart_id=data_mart_id,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; service_provider_id=service_provider_id,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; asset=aws_asset,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deployment=deployment,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; asset_properties=asset_properties,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background_mode=<span class="hljs-literal">False</span>
).result
</code></pre>
          <p>To get the subscription list, run the following command:</p>
          <pre class="codeblock"><code class="lang-python hljs">subscription_id = subscription_details.metadata.<span class="hljs-built_in">id</span>
subscription_id
&nbsp;
details: wos_client.subscriptions.get(subscription_id).result.to_dict()
</code></pre>
        </section>
        <section id="section-cml-smenlog">
          <h2 id="cml-smenlog">Enable payload logging</h2>
          <p>To enable payload logging, run the following command:</p>
          <pre class="codeblock"><code class="lang-python hljs">request_data = {<span class="hljs-string">'fields'</span>: feature_columns,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-string">'values'</span>: [[payload_values]]}
</code></pre>
          <p>To get logging details, run the following command:</p>
          <pre class="codeblock"><code class="lang-python hljs">response_data = {<span class="hljs-string">'fields'</span>: <span class="hljs-built_in">list</span>(result[<span class="hljs-string">'predictions'</span>][<span class="hljs-number">0</span>]),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-string">'values'</span>: [<span class="hljs-built_in">list</span>(x.values()) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> result[<span class="hljs-string">'predictions'</span>]]}
</code></pre>
        </section>
        <section id="section-cml-smscore">
          <h2 id="cml-smscore">Scoring and payload logging</h2>
          <ul>
            <li>Score your model. For a full example, see the <a href="https://github.com/IBM/watson-openscale-samples/blob/main/IBM%20Cloud/AWS%20Sagemaker/notebooks/Credit%20%20model%20with%20SageMaker%20linear-learner%20.ipynb" target="_blank" class="external">Working with SageMaker machine learning Engine Notebook</a>.</li>
          </ul>
          <p>To store the request and response in the payload logging table, run the following code:</p>
          <pre class="codeblock"><code class="lang-python hljs">wos_client.data_sets.store_records(data_set_id=payload_data_set_id, request_body=[PayloadRecord(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scoring_id=<span class="hljs-built_in">str</span>(uuid.uuid4()),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request=request_data,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response=response_data,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response_time=<span class="hljs-number">460</span>
)])
&nbsp;
</code></pre>
          <p note="">For languages other than Python, you can also log payload by using a REST API.</p>
          <p><strong>Parent topic:</strong> <a href="../model/wos-frameworks-ovr.html">Supported machine learning engines, frameworks, and models</a></p>
        </section>
      </section>
    </article>
  </main>

<script type="text/javascript"  src="/DEWsG3/JOI980/yQyM/iRupUf/mVarA/YDJa4kXtLhb7/LwkITClvAg/Wgkg/WmBVIDs"></script><link rel="stylesheet" type="text/css"  href="/_sec/cp_challenge/sec-4-4.css">
                                        <script  src="/_sec/cp_challenge/sec-cpt-4-4.js" async defer></script>
                                        <div id="sec-overlay" style="display:none;">
                                        <div id="sec-container">
                                        </div>
                                      </div></body></html>